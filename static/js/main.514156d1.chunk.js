(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{119:function(e,t,n){},121:function(e,t,n){},122:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),s=n(23),a=n.n(s),i=n(19),o=n.n(i),l=n(21),j=n.n(l),d=n(22),u=n(12),h=n(4),b=(n(118),n(127)),p=n(128),O=n(129),f=n(126),x=n(124),m=n(125),g=n(123),k=(n(119),n(1)),y=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),r=n[0],s=n[1],a=Object(c.useState)([]),i=Object(u.a)(a,2),o=i[0],l=i[1],j=Object(c.useState)(null),d=Object(u.a)(j,2),b=d[0],p=d[1],O=Object(c.useState)(null),f=Object(u.a)(O,2),x=f[0],m=f[1],g=Object(c.useState)("paste"),y=Object(u.a)(g,2),v=y[0],w=y[1];return Object(c.useEffect)((function(){m(Object(k.jsx)(h.p,{})),fetch("https://lpjakewolfskin.ru/api/v1/paste/get/top/").then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){m(null),s(e)})),fetch("https://lpjakewolfskin.ru/api/v1/member/get/top/").then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){m(null),l(e)})),m(Object(k.jsx)(h.p,{})),fetch("https://lpjakewolfskin.ru/api/v1/member/get_vk/"+e.fetchedUser.id).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){m(null),p(e)}))}),[]),Object(k.jsx)(h.v,{activePanel:e.id,popout:x,children:Object(k.jsxs)(h.m,{id:e.id,children:[Object(k.jsx)(h.n,{children:"\u0422\u041e\u041f"}),Object(k.jsxs)(h.t,{children:[Object(k.jsx)(h.u,{onClick:function(){return w("paste")},selected:"paste"===v,children:"\u041f\u0430\u0441\u0442\u044b"}),Object(k.jsx)(h.u,{onClick:function(){return w("member")},selected:"member"===v,children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438"})]}),Object(k.jsx)(h.j,{header:Object(k.jsx)(h.k,{mode:"secondary",children:"\u042d\u0442\u043e \u0442\u044b"}),children:Object(k.jsx)(h.f,{onClick:e.go,"data-to":"marks","data-member":b?b.vk_id:"",before:e.fetchedUser.photo_200?Object(k.jsx)(h.c,{src:e.fetchedUser.photo_200}):null,description:b?"\u0412\u0441\u0435\u0433\u043e \u043e\u0446\u0435\u043d\u043e\u043a: "+b.cnt+", \u0441\u0440\u0435\u0434\u043d\u044f\u044f: "+b.avg:"",children:"".concat(e.fetchedUser.first_name," ").concat(e.fetchedUser.last_name)})}),"paste"===v&&Object(k.jsx)(h.j,{header:Object(k.jsx)(h.k,{mode:"secondary",children:"\u0422\u041e\u041f \u043f\u0430\u0441\u0442"}),children:Object(k.jsx)(h.g,{children:r.map((function(t,n){return Object(k.jsx)(h.f,{onClick:e.gopanel,"data-story":"paste","data-payload":t.id,style:{marginBottom:".5rem"},description:"\u0412\u0441\u0435\u0433\u043e \u043e\u0446\u0435\u043d\u043e\u043a: "+t.cnt+", \u0440\u0435\u0439\u0442\u0438\u043d\u0433: "+t.rating,before:Object(k.jsx)(h.f,{disabled:!0,children:n+1}),children:t.anno},t.id)}))})}),"member"===v&&Object(k.jsx)(h.j,{header:Object(k.jsx)(h.k,{mode:"secondary",children:"\u0422\u041e\u041f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439"}),children:Object(k.jsx)(h.g,{children:o.map((function(t,n){return Object(k.jsx)(h.f,{onClick:e.go,"data-to":"marks","data-member":t.vk_id,style:{marginBottom:".5rem"},description:"\u0412\u0441\u0435\u0433\u043e \u043e\u0446\u0435\u043d\u043e\u043a: "+t.cnt+", \u0441\u0440\u0435\u0434\u043d\u044f\u044f: "+t.avg,before:Object(k.jsx)(h.f,{disabled:!0,children:n+1}),children:t.name},t.id)}))})})]})})},v=function(e){e.id;var t=e.go,n=e.fetchedUser,s=e.pastePreloaded,a=Object(c.useState)(null),i=Object(u.a)(a,2),l=i[0],v=i[1],w=Object(c.useState)(null),C=Object(u.a)(w,2),_=C[0],S=C[1],T=Object(c.useState)(null),E=Object(u.a)(T,2),A=E[0],U=E[1],z=r.a.useState("paste"),P=Object(u.a)(z,2),R=P[0],B=P[1],I=function(e){e.currentTarget.dataset.payload&&W(e.currentTarget.dataset.payload),B(e.currentTarget.dataset.story)};function K(){return V.apply(this,arguments)}function V(){return V=Object(d.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:U(Object(k.jsx)(h.p,{})),fetch("https://lpjakewolfskin.ru/api/v1/paste/get/unrelated/?vk_id="+n.id).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){U(null),v(e)}));case 2:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}function W(e){U(Object(k.jsx)(h.p,{})),fetch("https://lpjakewolfskin.ru/api/v1/paste/get/"+e+"/").then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){U(null),v(e)}))}function q(e){fetch("https://lpjakewolfskin.ru/api/v1/paste/relate/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:l.id,vk_id:n.id,mark:e})}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(){S(Object(k.jsx)(h.q,{onClose:function(){return S(null)},after:Object(k.jsx)(h.l,{onClick:function(){return S(null)},children:Object(k.jsx)(g.a,{})}),children:"\u041f\u0430\u0441\u0442\u0430 \u043e\u0446\u0435\u043d\u0435\u043d\u0430"}))}))}return Object(c.useEffect)((function(){s?W(s):K()}),[]),Object(k.jsxs)(h.h,{activeStory:R,tabbar:Object(k.jsxs)(h.r,{children:[Object(k.jsx)(h.s,{onClick:I,selected:"paste"===R,"data-story":"paste",text:"\u041f\u0430\u0441\u0442\u044b",children:Object(k.jsx)(x.a,{})}),Object(k.jsx)(h.s,{onClick:I,selected:"top"===R,"data-story":"top",text:"\u0422\u041e\u041f",children:Object(k.jsx)(m.a,{})})]}),children:[Object(k.jsx)(h.v,{id:"paste",activePanel:"paste",popout:A,children:Object(k.jsxs)(h.m,{id:"paste",children:[Object(k.jsx)(h.n,{children:"\u041f\u0410\u0421\u0422\u0415\u0420"}),l&&Object(k.jsxs)(h.j,{header:Object(k.jsxs)(h.k,{mode:"secondary",children:["\u0414\u0430\u043d\u043d\u0443\u044e \u043f\u0430\u0441\u0442\u0443 \u043e\u0446\u0435\u043d\u0438\u043b\u0438 ",l.cnt," \u0440\u0430\u0437, \u0440\u0435\u0439\u0442\u0438\u043d\u0433 - ",l.rating," ",l.sender?"\u041f\u0430\u0441\u0442\u0443 \u043f\u0440\u0438\u0441\u043b\u0430\u043b "+l.sender.name:""]}),children:[Object(k.jsx)(h.g,{children:Object(k.jsx)(h.e,{size:"l",mode:"shadow",style:{marginBottom:"1rem"},children:Object(k.jsxs)(h.g,{style:{padding:".5rem",margin:"auto"},children:[Object(k.jsx)("p",{children:l.clear_text}),l.pic&&Object(k.jsx)("img",{style:{width:"100%",height:"100%"},src:l.pic_link,onClick:Object(d.a)(j.a.mark((function e(){var t,n,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.send("VKWebAppGetAuthToken",{app_id:7983387,scope:"photos"});case 2:return t=e.sent,n=l.pic.split("_")[0].split("photo")[1],c=l.pic.split("_")[1].slice(0,-1),e.next=7,o.a.send("VKWebAppCallAPIMethod",{method:"photos.copy",request_id:"32test",params:{owner_id:n,photo_id:c,v:"5.131",access_token:t.access_token}});case 7:e.sent.error_type?S(Object(k.jsx)(h.q,{onClose:function(){return S(null)},after:Object(k.jsx)(h.l,{onClick:function(){return S(null)},children:Object(k.jsx)(g.a,{})}),children:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"})):S(Object(k.jsx)(h.q,{onClose:function(){return S(null)},after:Object(k.jsx)(h.l,{onClick:function(){return S(null)},children:Object(k.jsx)(g.a,{})}),children:"\u041f\u0438\u043a\u0447\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430 \u0432 \u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435"}));case 9:case"end":return e.stop()}}),e)})))}),l.pic&&Object(k.jsx)(h.g,{style:{textAlign:"center",color:"gray"},children:"\u041d\u0430\u0436\u043c\u0438 \u043d\u0430 \u043f\u0438\u043a\u0447\u0443, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0435\u0435 \u0432 \u0441\u0432\u043e\u0438 \u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043a\u0438"})]})})}),Object(k.jsx)(h.g,{style:{margin:"auto"}}),Object(k.jsxs)(h.j,{header:Object(k.jsx)(h.k,{mode:"secondary",children:"\u041e\u0446\u0435\u043d\u0438\u0442\u0435 \u043f\u0430\u0441\u0442\u0443"}),children:[!l.related&&Object(k.jsxs)(h.g,{style:{display:"flex"},children:[Object(k.jsxs)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"destructive",onClick:function(){q(1)},children:["1 ",Object(k.jsx)(f.a,{})]}),Object(k.jsxs)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"destructive",onClick:function(){q(2)},children:["2 ",Object(k.jsx)(f.a,{})]}),Object(k.jsxs)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"secondary",onClick:function(){q(3)},children:["3 ",Object(k.jsx)(f.a,{})]}),Object(k.jsxs)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"commerce",onClick:function(){q(4)},children:["4 ",Object(k.jsx)(f.a,{})]}),Object(k.jsxs)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"commerce",onClick:function(){q(5)},children:["5 ",Object(k.jsx)(f.a,{})]})]}),l.related&&Object(k.jsx)(h.g,{style:{textAlign:"center",color:"gray"},children:"\u0412\u044b \u0443\u0436\u0435 \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u043b\u0438 \u0434\u0430\u043d\u043d\u0443\u044e \u043f\u0430\u0441\u0442\u0443"}),Object(k.jsx)(h.g,{style:{paddingBottom:"9rem"},children:Object(k.jsx)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"primary",onClick:function(){o.a.send("VKWebAppShare",{link:l.link})},before:Object(k.jsx)(b.a,{}),children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f"})})]}),Object(k.jsx)(h.i,{filled:!0,vertical:"bottom",children:Object(k.jsx)(h.j,{header:Object(k.jsx)(h.k,{mode:"secondary",children:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u0430\u0441\u0442\u0443"}),children:Object(k.jsxs)(h.g,{style:{display:"flex"},children:[Object(k.jsx)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"secondary",onClick:function(){U(Object(k.jsx)(h.p,{})),fetch("https://lpjakewolfskin.ru/api/v1/paste/get/rand/?vk_id="+n.id).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){U(null),v(e)}))},before:Object(k.jsx)(p.a,{}),children:"\u0421\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u043f\u0430\u0441\u0442\u0430"}),Object(k.jsx)(h.d,{stretched:!0,size:"l",mode:"secondary",onClick:function(){K()},before:Object(k.jsx)(O.a,{}),children:"\u041d\u0435\u043e\u0446\u0435\u043d\u0435\u043d\u043d\u0430\u044f \u043f\u0430\u0441\u0442\u0430"})]})})})]}),_]})}),Object(k.jsx)(y,{id:"top",fetchedUser:n,go:t,gopanel:I})]})},w=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),r=(n[0],n[1],Object(c.useState)(null)),s=Object(u.a)(r,2),a=s[0],i=s[1],o=Object(c.useState)(null),l=Object(u.a)(o,2),j=l[0],d=l[1],b={month:"long",day:"numeric",hour:"numeric",minute:"numeric"};return Object(c.useEffect)((function(){d(Object(k.jsx)(h.p,{})),fetch("https://lpjakewolfskin.ru/api/v1/member/get_vk/"+e.member).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){d(null),i(e)}))}),[]),Object(k.jsx)(h.v,{activePanel:e.id,popout:j,children:Object(k.jsxs)(h.m,{id:e.id,children:[Object(k.jsx)(h.n,{left:Object(k.jsx)(h.o,{onClick:e.go,"data-to":"top"}),children:"\u041e\u0446\u0435\u043d\u043a\u0438"}),Object(k.jsx)(h.j,{header:Object(k.jsx)(h.k,{mode:"secondary",children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(k.jsx)(h.f,{description:a?"\u0412\u0441\u0435\u0433\u043e \u043e\u0446\u0435\u043d\u043e\u043a: "+a.cnt+", \u0441\u0440\u0435\u0434\u043d\u044f\u044f: "+a.avg:"",children:a?a.name:""})}),Object(k.jsx)(h.j,{header:Object(k.jsx)(h.k,{mode:"secondary",children:"\u041f\u0430\u0441\u0442\u044b"}),children:Object(k.jsx)(h.g,{children:a&&a.marks.map((function(t,n){var c=new Date(t.created_at);return Object(k.jsx)(h.f,{onClick:e.go,"data-to":"home","data-payload":t.paste.id,style:{marginBottom:".5rem"},description:c.toLocaleString("ru",b),before:Object(k.jsxs)(h.f,{disabled:!0,style:{alignItems:"center",textAlign:"center"},children:[t.mark," ",Object(k.jsx)(f.a,{})]}),children:t.paste.anno},t.paste.id)}))})})]})})},C=function(){var e=Object(c.useState)("home"),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(null),a=Object(u.a)(s,2),i=a[0],l=a[1],b=Object(c.useState)(null),p=Object(u.a)(b,2),O=p[0],f=p[1],x=Object(c.useState)(null),m=Object(u.a)(x,2),g=m[0],C=m[1],_=Object(c.useState)(Object(k.jsx)(h.p,{size:"large"})),S=Object(u.a)(_,2),T=S[0],E=S[1];Object(c.useEffect)((function(){function e(){return(e=Object(d.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.send("VKWebAppGetUserInfo");case 2:t=e.sent,l(t),E(null);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}o.a.subscribe((function(e){var t=e.detail,n=t.type,c=t.data;if("VKWebAppUpdateConfig"===n){var r=document.createAttribute("scheme");r.value=c.scheme?c.scheme:"client_light",document.body.attributes.setNamedItem(r)}})),function(){e.apply(this,arguments)}()}),[]);var A=function(e){r(e.currentTarget.dataset.to),f(e.currentTarget.dataset.payload),C(e.currentTarget.dataset.member)};return Object(k.jsx)(h.a,{children:Object(k.jsx)(h.b,{children:Object(k.jsxs)(h.v,{activePanel:n,popout:T,children:[i&&Object(k.jsx)(v,{id:"home",fetchedUser:i,go:A,pastePreloaded:O}),i&&Object(k.jsx)(y,{id:"top",fetchedUser:i,go:A}),Object(k.jsx)(w,{id:"marks",go:A,member:g})]})})})};n(121);o.a.send("VKWebAppInit"),a.a.render(Object(k.jsx)(C,{}),document.getElementById("root"))}},[[122,1,2]]]);
//# sourceMappingURL=main.514156d1.chunk.js.map