(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{119:function(e,t,n){},121:function(e,t,n){},122:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n.n(c),r=n(22),a=n.n(r),i=n(20),o=n.n(i),j=n(21),l=n.n(j),d=n(23),u=n(12),h=n(4),b=(n(118),n(126)),O=n(127),f=n(128),p=n(125),m=n(123),x=n(124),g=(n(119),n(2)),k=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),s=n[0],r=n[1],a=Object(c.useState)([]),i=Object(u.a)(a,2),o=i[0],j=i[1],l=Object(c.useState)(null),d=Object(u.a)(l,2),b=d[0],O=d[1],f=Object(c.useState)(null),p=Object(u.a)(f,2),m=p[0],x=p[1],k=Object(c.useState)("paste"),y=Object(u.a)(k,2),v=y[0],w=y[1];return Object(c.useEffect)((function(){x(Object(g.jsx)(h.o,{})),fetch("https://lpjakewolfskin.ru/api/v1/paste/get/top/").then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){x(null),r(e)})),fetch("https://lpjakewolfskin.ru/api/v1/member/get/top/").then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){x(null),j(e)})),x(Object(g.jsx)(h.o,{})),fetch("https://lpjakewolfskin.ru/api/v1/member/get_vk/"+e.fetchedUser.id).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){x(null),O(e)}))}),[]),Object(g.jsx)(h.u,{activePanel:e.id,popout:m,children:Object(g.jsxs)(h.l,{id:e.id,children:[Object(g.jsx)(h.m,{left:Object(g.jsx)(h.n,{onClick:e.go,"data-to":"home"}),children:"\u0422\u041e\u041f"}),Object(g.jsxs)(h.s,{children:[Object(g.jsx)(h.t,{onClick:function(){return w("paste")},selected:"paste"===v,children:"\u041f\u0430\u0441\u0442\u044b"}),Object(g.jsx)(h.t,{onClick:function(){return w("member")},selected:"member"===v,children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438"})]}),Object(g.jsx)(h.j,{header:Object(g.jsx)(h.k,{mode:"secondary",children:"\u042d\u0442\u043e \u0442\u044b"}),children:Object(g.jsx)(h.f,{onClick:e.go,"data-to":"marks","data-member":b?b.vk_id:"",before:e.fetchedUser.photo_200?Object(g.jsx)(h.c,{src:e.fetchedUser.photo_200}):null,description:b?"\u0412\u0441\u0435\u0433\u043e \u043e\u0446\u0435\u043d\u043e\u043a: "+b.cnt+", \u0441\u0440\u0435\u0434\u043d\u044f\u044f: "+b.avg:"",children:"".concat(e.fetchedUser.first_name," ").concat(e.fetchedUser.last_name)})}),"paste"===v&&Object(g.jsx)(h.j,{header:Object(g.jsx)(h.k,{mode:"secondary",children:"\u0422\u041e\u041f \u043f\u0430\u0441\u0442"}),children:Object(g.jsx)(h.g,{children:s.map((function(t,n){return Object(g.jsx)(h.f,{onClick:e.gopanel,"data-story":"paste","data-payload":t.id,style:{marginBottom:".5rem"},description:"\u0412\u0441\u0435\u0433\u043e \u043e\u0446\u0435\u043d\u043e\u043a: "+t.cnt+", \u0440\u0435\u0439\u0442\u0438\u043d\u0433: "+t.rating,before:Object(g.jsx)(h.f,{disabled:!0,children:n+1}),children:t.anno},t.id)}))})}),"member"===v&&Object(g.jsx)(h.j,{header:Object(g.jsx)(h.k,{mode:"secondary",children:"\u0422\u041e\u041f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439"}),children:Object(g.jsx)(h.g,{children:o.map((function(t,n){return Object(g.jsx)(h.f,{onClick:e.go,"data-to":"marks","data-member":t.vk_id,style:{marginBottom:".5rem"},description:"\u0412\u0441\u0435\u0433\u043e \u043e\u0446\u0435\u043d\u043e\u043a: "+t.cnt+", \u0441\u0440\u0435\u0434\u043d\u044f\u044f: "+t.avg,before:Object(g.jsx)(h.f,{disabled:!0,children:n+1}),children:t.name},t.id)}))})})]})})},y=function(e){e.id;var t=e.go,n=e.fetchedUser,r=e.pastePreloaded,a=Object(c.useState)(null),i=Object(u.a)(a,2),j=i[0],y=i[1],v=Object(c.useState)(null),w=Object(u.a)(v,2),S=w[0],C=w[1],T=Object(c.useState)(null),_=Object(u.a)(T,2),E=_[0],U=_[1],z=s.a.useState("paste"),P=Object(u.a)(z,2),R=P[0],A=P[1],B=function(e){e.currentTarget.dataset.payload&&V(e.currentTarget.dataset.payload),A(e.currentTarget.dataset.story)};function I(){return K.apply(this,arguments)}function K(){return K=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:U(Object(g.jsx)(h.o,{})),fetch("https://lpjakewolfskin.ru/api/v1/paste/get/unrelated/?vk_id="+n.id).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){U(null),y(e)}));case 2:case"end":return e.stop()}}),e)}))),K.apply(this,arguments)}function V(e){U(Object(g.jsx)(h.o,{})),fetch("https://lpjakewolfskin.ru/api/v1/paste/get/"+e+"/").then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){U(null),y(e)}))}function W(e){fetch("https://lpjakewolfskin.ru/api/v1/paste/relate/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:j.id,vk_id:n.id,mark:e})}).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(){C(Object(g.jsx)(h.p,{onClose:function(){return C(null)},children:"\u041f\u0430\u0441\u0442\u0430 \u043e\u0446\u0435\u043d\u0435\u043d\u0430"}))}))}return Object(c.useEffect)((function(){r?V(r):I()}),[]),Object(g.jsxs)(h.h,{activeStory:R,tabbar:Object(g.jsxs)(h.q,{children:[Object(g.jsx)(h.r,{onClick:B,selected:"paste"===R,"data-story":"paste",text:"\u041f\u0430\u0441\u0442\u044b",children:Object(g.jsx)(m.a,{})}),Object(g.jsx)(h.r,{onClick:B,selected:"top"===R,"data-story":"top",text:"\u0422\u041e\u041f",children:Object(g.jsx)(x.a,{})})]}),children:[Object(g.jsx)(h.u,{id:"paste",activePanel:"paste",popout:E,children:Object(g.jsxs)(h.l,{id:"paste",children:[Object(g.jsx)(h.m,{children:"\u041f\u0410\u0421\u0422\u0415\u0420"}),j&&Object(g.jsxs)(h.j,{header:Object(g.jsxs)(h.k,{mode:"secondary",children:["\u0414\u0430\u043d\u043d\u0443\u044e \u043f\u0430\u0441\u0442\u0443 \u043e\u0446\u0435\u043d\u0438\u043b\u0438 ",j.cnt," \u0440\u0430\u0437, \u0440\u0435\u0439\u0442\u0438\u043d\u0433 - ",j.rating]}),children:[Object(g.jsx)(h.g,{children:Object(g.jsx)(h.e,{size:"l",mode:"shadow",style:{marginBottom:"1rem"},children:Object(g.jsxs)(h.g,{style:{padding:".5rem",margin:"auto"},children:[Object(g.jsx)("p",{children:j.clear_text}),Object(g.jsx)("img",{style:{width:"100%",height:"100%"},src:j.pic_link})]})})}),Object(g.jsx)(h.g,{style:{margin:"auto"}}),Object(g.jsxs)(h.j,{header:Object(g.jsx)(h.k,{mode:"secondary",children:"\u041e\u0446\u0435\u043d\u0438\u0442\u0435 \u043f\u0430\u0441\u0442\u0443"}),children:[Object(g.jsxs)(h.g,{style:{display:"flex"},children:[Object(g.jsxs)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"destructive",onClick:function(){W(1)},children:["1 ",Object(g.jsx)(p.a,{})]}),Object(g.jsxs)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"destructive",onClick:function(){W(2)},children:["2 ",Object(g.jsx)(p.a,{})]}),Object(g.jsxs)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"secondary",onClick:function(){W(3)},children:["3 ",Object(g.jsx)(p.a,{})]}),Object(g.jsxs)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"commerce",onClick:function(){W(4)},children:["4 ",Object(g.jsx)(p.a,{})]}),Object(g.jsxs)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"commerce",onClick:function(){W(5)},children:["5 ",Object(g.jsx)(p.a,{})]})]}),Object(g.jsx)(h.g,{style:{paddingBottom:"9rem"},children:Object(g.jsx)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"primary",onClick:function(){o.a.send("VKWebAppShare",{link:j.link})},before:Object(g.jsx)(b.a,{}),children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f"})})]}),Object(g.jsx)(h.i,{filled:!0,vertical:"bottom",children:Object(g.jsx)(h.j,{header:Object(g.jsx)(h.k,{mode:"secondary",children:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u0430\u0441\u0442\u0443"}),children:Object(g.jsxs)(h.g,{style:{display:"flex"},children:[Object(g.jsx)(h.d,{stretched:!0,size:"l",style:{marginRight:8},mode:"secondary",onClick:function(){U(Object(g.jsx)(h.o,{})),fetch("https://lpjakewolfskin.ru/api/v1/paste/get/rand/").then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){U(null),y(e)}))},before:Object(g.jsx)(O.a,{}),children:"\u0421\u043b\u0443\u0447\u0430\u0439\u043d\u0430\u044f \u043f\u0430\u0441\u0442\u0430"}),Object(g.jsx)(h.d,{stretched:!0,size:"l",mode:"secondary",onClick:function(){I()},before:Object(g.jsx)(f.a,{}),children:"\u041d\u0435\u043e\u0446\u0435\u043d\u0435\u043d\u043d\u0430\u044f \u043f\u0430\u0441\u0442\u0430"})]})})})]}),S]})}),Object(g.jsx)(k,{id:"top",fetchedUser:n,go:t,gopanel:B})]})},v=function(e){var t=Object(c.useState)([]),n=Object(u.a)(t,2),s=(n[0],n[1],Object(c.useState)(null)),r=Object(u.a)(s,2),a=r[0],i=r[1],o=Object(c.useState)(null),j=Object(u.a)(o,2),l=j[0],d=j[1],b={month:"long",day:"numeric",hour:"numeric",minute:"numeric"};return Object(c.useEffect)((function(){d(Object(g.jsx)(h.o,{})),fetch("https://lpjakewolfskin.ru/api/v1/member/get_vk/"+e.member).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((function(e){console.log(e)})).then((function(e){d(null),i(e)}))}),[]),Object(g.jsx)(h.u,{activePanel:e.id,popout:l,children:Object(g.jsxs)(h.l,{id:e.id,children:[Object(g.jsx)(h.m,{left:Object(g.jsx)(h.n,{onClick:e.go,"data-to":"top"}),children:"\u041e\u0446\u0435\u043d\u043a\u0438"}),Object(g.jsx)(h.j,{header:Object(g.jsx)(h.k,{mode:"secondary",children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),children:Object(g.jsx)(h.f,{description:a?"\u0412\u0441\u0435\u0433\u043e \u043e\u0446\u0435\u043d\u043e\u043a: "+a.cnt+", \u0441\u0440\u0435\u0434\u043d\u044f\u044f: "+a.avg:"",children:a?a.name:""})}),Object(g.jsx)(h.j,{header:Object(g.jsx)(h.k,{mode:"secondary",children:"\u041f\u0430\u0441\u0442\u044b"}),children:Object(g.jsx)(h.g,{children:a&&a.marks.map((function(t,n){var c=new Date(t.created_at);return Object(g.jsx)(h.f,{onClick:e.go,"data-to":"home","data-payload":t.paste.id,style:{marginBottom:".5rem"},description:c.toLocaleString("ru",b),before:Object(g.jsxs)(h.f,{disabled:!0,style:{alignItems:"center",textAlign:"center"},children:[t.mark," ",Object(g.jsx)(p.a,{})]}),children:t.paste.anno},t.paste.id)}))})})]})})},w=function(){var e=Object(c.useState)("home"),t=Object(u.a)(e,2),n=t[0],s=t[1],r=Object(c.useState)(null),a=Object(u.a)(r,2),i=a[0],j=a[1],b=Object(c.useState)(null),O=Object(u.a)(b,2),f=O[0],p=O[1],m=Object(c.useState)(null),x=Object(u.a)(m,2),w=x[0],S=x[1],C=Object(c.useState)(Object(g.jsx)(h.o,{size:"large"})),T=Object(u.a)(C,2),_=T[0],E=T[1];Object(c.useEffect)((function(){function e(){return(e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.send("VKWebAppGetUserInfo");case 2:t=e.sent,j(t),E(null);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}o.a.subscribe((function(e){var t=e.detail,n=t.type,c=t.data;if("VKWebAppUpdateConfig"===n){var s=document.createAttribute("scheme");s.value=c.scheme?c.scheme:"client_light",document.body.attributes.setNamedItem(s)}})),function(){e.apply(this,arguments)}()}),[]);var U=function(e){s(e.currentTarget.dataset.to),p(e.currentTarget.dataset.payload),S(e.currentTarget.dataset.member)};return Object(g.jsx)(h.a,{children:Object(g.jsx)(h.b,{children:Object(g.jsxs)(h.u,{activePanel:n,popout:_,children:[i&&Object(g.jsx)(y,{id:"home",fetchedUser:i,go:U,pastePreloaded:f}),i&&Object(g.jsx)(k,{id:"top",fetchedUser:i,go:U}),Object(g.jsx)(v,{id:"marks",go:U,member:w})]})})})};n(121);o.a.send("VKWebAppInit"),a.a.render(Object(g.jsx)(w,{}),document.getElementById("root"))}},[[122,1,2]]]);
//# sourceMappingURL=main.a232187a.chunk.js.map