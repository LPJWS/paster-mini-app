{"version":3,"sources":["panels/Home.js","App.js","index.js"],"names":["Home","id","fetchedUser","go","useState","paste","setPaste","snackbar","setSnackbar","popout","setPopout","getPaste","console","log","fetch","then","response","ok","Error","statusText","json","catch","err","relatePaste","mark","method","headers","body","JSON","stringify","vk_id","onClose","useEffect","activePanel","header","mode","before","photo_200","src","description","city","title","first_name","last_name","cnt","rating","size","style","marginBottom","padding","clear_text","display","paddingBottom","stretched","marginRight","onClick","filled","vertical","App","setActivePanel","setUser","a","bridge","send","user","subscribe","detail","type","data","schemeAttribute","document","createAttribute","value","scheme","attributes","setNamedItem","fetchData","e","currentTarget","dataset","to","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.98c21d58.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\n\nimport { Panel, PanelHeader, Header, Button, Group, Cell, Div, ScreenSpinner, Text, Avatar, Card, Snackbar, FixedLayout, Separator, View } from '@vkontakte/vkui';\n\nconst Home = ({ id, go, fetchedUser }) => {\n\tconst [ paste, setPaste] = useState([]);\n\tconst [ snackbar, setSnackbar] = useState(null);\n\tconst [ popout, setPopout] = useState(null);\n\n\t// console.log(fetchedUser)\n\t\n\tfunction getRandPaste() {\n\t\tsetPopout(<ScreenSpinner/>)\n\t\tfetch('https://lpjakewolfskin.ru/api/v1/paste/get/rand/')\n\t\t  .then(response => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow new Error(response.statusText)\n\t\t\t\t}\n\t\t\t\treturn response.json()\n\t\t\t\t}).catch(err=>{\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t\t  .then(paste => {\n\t\t\tsetPopout(null)\n\t\t\tsetPaste(paste)\n\t\t  })\n\t}\n\n\tfunction getPaste() {\n\t\tconsole.log(fetchedUser)\n\t\twhile (!fetchedUser) {\n\t\t\treturn\n\t\t}\n\t\tsetPopout(<ScreenSpinner/>)\n\t\tfetch('https://lpjakewolfskin.ru/api/v1/paste/get/unrelated/?vk_id=' + fetchedUser.id)\n\t\t  .then(response => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow new Error(response.statusText)\n\t\t\t\t}\n\t\t\t\treturn response.json()\n\t\t\t\t}).catch(err=>{\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t\t  .then(paste => {\n\t\t\tsetPopout(null)\n\t\t\tsetPaste(paste)\n\t\t  })\n\t}\n\n\tfunction relatePaste(mark) {\n\t\tfetch('https://lpjakewolfskin.ru/api/v1/paste/relate/', {\n\t\t\tmethod: 'POST',\n\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\tbody: JSON.stringify({ id: paste.id, vk_id: fetchedUser.id, mark })\n\t\t})\n\t\t  .then(response => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow new Error(response.statusText)\n\t\t\t\t}\n\t\t\t\treturn response.json()\n\t\t\t\t}).catch(err=>{\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t\t  .then(() => {\n\t\t\tsetSnackbar(\n\t\t\t\t<Snackbar\n\t\t\t\t\tonClose={() => setSnackbar(null)}\n\t\t\t\t>\n\t\t\t\t\tПаста оценена\n\t\t\t\t</Snackbar>\n\t\t\t)\n\t\t  })\n\t}\n\n\tuseEffect(() => {\n\t\tgetPaste()\n\t  }, [])\n\n\treturn (\n\t\t<View activePanel={id} popout={popout}>\n\t\t\t<Panel id={id}>\n\t\t\t\t<PanelHeader>ПАСТЕР</PanelHeader>\n\t\t\t\t{fetchedUser &&\n\t\t\t\t<Group header={<Header mode=\"secondary\">Это ты</Header>}>\n\t\t\t\t\t<Cell\n\t\t\t\t\t\tbefore={fetchedUser.photo_200 ? <Avatar src={fetchedUser.photo_200}/> : null}\n\t\t\t\t\t\tdescription={fetchedUser.city && fetchedUser.city.title ? fetchedUser.city.title : ''}\n\t\t\t\t\t>\n\t\t\t\t\t\t{`${fetchedUser.first_name} ${fetchedUser.last_name}`}\n\t\t\t\t\t</Cell>\n\t\t\t\t</Group>}\n\n\t\t\t\t<Group header={<Header mode=\"secondary\">Данную пасту оценили {paste.cnt} раз, рейтинг - {paste.rating}</Header>}>\n\t\t\t\t\t<Div>\n\t\t\t\t\t\t<Card size=\"l\" mode=\"shadow\" style={{marginBottom:'1rem'}}>\n\t\t\t\t\t\t\t<Div style={{padding: '.5rem'}}><p>{paste.clear_text}</p></Div>\n\t\t\t\t\t\t</Card>\n\t\t\t\t\t</Div>\n\t\t\t\t\t<Group header={<Header mode=\"secondary\">Оцените пасту</Header>}>\n\t\t\t\t\t\t<Div style={{display: 'flex', paddingBottom: '9rem'}}>\n\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"destructive\" onClick={() => {relatePaste(1)}}>\n\t\t\t\t\t\t\t\t1\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"destructive\" onClick={() => {relatePaste(2)}}>\n\t\t\t\t\t\t\t\t2\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"secondary\" onClick={() => {relatePaste(3)}}>\n\t\t\t\t\t\t\t\t3\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"commerce\" onClick={() => {relatePaste(4)}}>\n\t\t\t\t\t\t\t\t4\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"commerce\" onClick={() => {relatePaste(5)}}>\n\t\t\t\t\t\t\t\t5\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Div>\n\t\t\t\t\t</Group>\n\t\t\t\t\t<FixedLayout filled vertical=\"bottom\">\n\t\t\t\t\t\t<Group header={<Header mode=\"secondary\">Получить пасту</Header>}>\n\t\t\t\t\t\t\t<Div style={{display: 'flex'}}>\n\t\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"secondary\" onClick={\n\t\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\t\tgetRandPaste()\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}>\n\t\t\t\t\t\t\t\t\tСлучайная паста\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button stretched size=\"l\" mode=\"secondary\" onClick={\n\t\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\t\tgetPaste()\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}>\n\t\t\t\t\t\t\t\t\tНеоцененная паста\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t</Group>\n\t\t\t\t\t</FixedLayout>\n\t\t\t\t</Group>\n\t\t\t\t{snackbar}\n\t\t\t</Panel>\n\t\t</View>\n\t)\n};\n\nHome.propTypes = {\n\tid: PropTypes.string.isRequired,\n\tgo: PropTypes.func.isRequired,\n\tfetchedUser: PropTypes.shape({\n\t\tphoto_200: PropTypes.string,\n\t\tfirst_name: PropTypes.string,\n\t\tlast_name: PropTypes.string,\n\t\tcity: PropTypes.shape({\n\t\t\ttitle: PropTypes.string,\n\t\t}),\n\t}),\n};\n\nexport default Home;\n","import React, { useState, useEffect } from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport { View, ScreenSpinner, AdaptivityProvider, AppRoot } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport Home from './panels/Home';\nimport Top from './panels/Top';\n\nconst App = () => {\n\tconst [activePanel, setActivePanel] = useState('home');\n\tconst [fetchedUser, setUser] = useState(null);\n\tconst [popout, setPopout] = useState(<ScreenSpinner size='large' />);\n\n\tuseEffect(() => {\n\t\tbridge.subscribe(({ detail: { type, data }}) => {\n\t\t\tif (type === 'VKWebAppUpdateConfig') {\n\t\t\t\tconst schemeAttribute = document.createAttribute('scheme');\n\t\t\t\tschemeAttribute.value = data.scheme ? data.scheme : 'client_light';\n\t\t\t\tdocument.body.attributes.setNamedItem(schemeAttribute);\n\t\t\t}\n\t\t});\n\t\tasync function fetchData() {\n\t\t\tconst user = await bridge.send('VKWebAppGetUserInfo');\n\t\t\tsetUser(user);\n\t\t\tsetPopout(null);\n\t\t}\n\t\tfetchData();\n\t}, []);\n\n\tconst go = e => {\n\t\tsetActivePanel(e.currentTarget.dataset.to);\n\t};\n\n\treturn (\n\t\t<AdaptivityProvider>\n\t\t\t<AppRoot>\n\t\t\t\t<View activePanel={activePanel} popout={popout}>\n\t\t\t\t\t<Home id='home' fetchedUser={fetchedUser} go={go} />\n\t\t\t\t</View>\n\t\t\t</AppRoot>\n\t\t</AdaptivityProvider>\n\t);\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\nimport './index.css';\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\nif (process.env.NODE_ENV === \"development\") {\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\n}\n"],"sourceRoot":""}