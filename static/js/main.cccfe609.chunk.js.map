{"version":3,"sources":["panels/Home.js","panels/Top.js","App.js","index.js"],"names":["Home","id","go","fetchedUser","pastePreloaded","useState","paste","setPaste","snackbar","setSnackbar","popout","setPopout","getPaste","a","fetch","then","response","ok","Error","statusText","json","catch","err","console","log","relatePaste","mark","method","headers","body","JSON","stringify","vk_id","onClose","useEffect","paste_id","activePanel","header","mode","cnt","rating","size","style","marginBottom","padding","clear_text","display","stretched","marginRight","onClick","bridge","send","link","before","paddingBottom","filled","vertical","Top","props","pastes","setPastes","users","setUsers","you","setYou","left","photo_200","src","description","avg","first_name","last_name","map","index","disabled","anno","user","name","App","setActivePanel","setUser","setPastePreloaded","subscribe","detail","type","data","schemeAttribute","document","createAttribute","value","scheme","attributes","setNamedItem","fetchData","e","currentTarget","dataset","to","payload","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.cccfe609.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport PropTypes, { func } from 'prop-types';\nimport bridge from '@vkontakte/vk-bridge';\n\nimport { Panel, PanelHeader, Header, Button, Group, Cell, Div, ScreenSpinner, Text, Avatar, Card, Snackbar, FixedLayout, Separator, View } from '@vkontakte/vkui';\nimport { Icon16ReplyOutline } from '@vkontakte/icons';\nimport { Icon28Dice5Outline } from '@vkontakte/icons';\nimport { Icon28ViewOutline } from '@vkontakte/icons';\nimport { Icon16Mention } from '@vkontakte/icons';\nimport { Icon24CupOutline } from '@vkontakte/icons';\nimport { Icon16Favorite } from '@vkontakte/icons';\n\nconst Home = ({ id, go, fetchedUser, pastePreloaded }) => {\n\tconst [ paste, setPaste] = useState(null);\n\tconst [ snackbar, setSnackbar] = useState(null);\n\tconst [ popout, setPopout] = useState(null);\n\t\n\tfunction getRandPaste() {\n\t\tsetPopout(<ScreenSpinner/>)\n\t\tfetch('https://lpjakewolfskin.ru/api/v1/paste/get/rand/')\n\t\t  .then(response => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow new Error(response.statusText)\n\t\t\t\t}\n\t\t\t\treturn response.json()\n\t\t\t\t}).catch(err=>{\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t\t  .then(paste => {\n\t\t\tsetPopout(null)\n\t\t\tsetPaste(paste)\n\t\t  })\n\t}\n\n\tasync function getPaste() {\n\t\tsetPopout(<ScreenSpinner/>)\n\t\tfetch('https://lpjakewolfskin.ru/api/v1/paste/get/unrelated/?vk_id=' + fetchedUser.id)\n\t\t  .then(response => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow new Error(response.statusText)\n\t\t\t\t}\n\t\t\t\treturn response.json()\n\t\t\t\t}).catch(err=>{\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t\t  .then(paste => {\n\t\t\tsetPopout(null)\n\t\t\tsetPaste(paste)\n\t\t  })\n\t}\n\n\tfunction getPasteById(paste_id) {\n\t\tsetPopout(<ScreenSpinner/>)\n\t\tfetch('https://lpjakewolfskin.ru/api/v1/paste/get/' + paste_id + '/')\n\t\t  .then(response => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow new Error(response.statusText)\n\t\t\t\t}\n\t\t\t\treturn response.json()\n\t\t\t\t}).catch(err=>{\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t\t  .then(paste => {\n\t\t\tsetPopout(null)\n\t\t\tsetPaste(paste)\n\t\t  })\n\t}\n\n\tfunction relatePaste(mark) {\n\t\tfetch('https://lpjakewolfskin.ru/api/v1/paste/relate/', {\n\t\t\tmethod: 'POST',\n\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\tbody: JSON.stringify({ id: paste.id, vk_id: fetchedUser.id, mark })\n\t\t})\n\t\t  .then(response => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow new Error(response.statusText)\n\t\t\t\t}\n\t\t\t\treturn response.json()\n\t\t\t\t}).catch(err=>{\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t\t  .then(() => {\n\t\t\tsetSnackbar(\n\t\t\t\t<Snackbar\n\t\t\t\t\tonClose={() => setSnackbar(null)}\n\t\t\t\t>\n\t\t\t\t\tПаста оценена\n\t\t\t\t</Snackbar>\n\t\t\t)\n\t\t  })\n\t}\n\n\tfunction reply() {\n\t\tbridge.send(\"VKWebAppShare\", {\"link\": paste.link});\n\n\t\t// bridge.send(\"VKWebAppShowWallPostBox\", {\"message\": \"Hello!\", \"attachments\": \"wall-\"+paste.group+\"_\"+paste.post});\n\t}\n\n\tuseEffect(() => {\n\t\tif (pastePreloaded) {\n\t\t\tgetPasteById(pastePreloaded)\n\t\t}\n\t\telse {\n\t\t\tgetPaste()\n\t\t}\n\t  }, [])\n\n\treturn (\n\t\t<View activePanel={id} popout={popout}>\n\t\t\t<Panel id={id}>\n\t\t\t\t<PanelHeader>ПАСТЕР</PanelHeader>\n\t\t\t\t{paste && \n\t\t\t\t\t<Group header={<Header mode=\"secondary\">Данную пасту оценили {paste.cnt} раз, рейтинг - {paste.rating}</Header>}>\n\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t<Card size=\"l\" mode=\"shadow\" style={{marginBottom:'1rem'}}>\n\t\t\t\t\t\t\t\t<Div style={{padding: '.5rem'}}><p>{paste.clear_text}</p></Div>\n\t\t\t\t\t\t\t</Card>\n\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t<Group header={<Header mode=\"secondary\">Оцените пасту</Header>}>\n\t\t\t\t\t\t\t<Div style={{display: 'flex'}}>\n\t\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"destructive\" onClick={() => {relatePaste(1)}}>\n\t\t\t\t\t\t\t\t\t1 <Icon16Favorite/>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"destructive\" onClick={() => {relatePaste(2)}}>\n\t\t\t\t\t\t\t\t\t2 <Icon16Favorite/>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"secondary\" onClick={() => {relatePaste(3)}}>\n\t\t\t\t\t\t\t\t\t3 <Icon16Favorite/>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"commerce\" onClick={() => {relatePaste(4)}}>\n\t\t\t\t\t\t\t\t\t4 <Icon16Favorite/>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"commerce\" onClick={() => {relatePaste(5)}}>\n\t\t\t\t\t\t\t\t\t5 <Icon16Favorite/>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"primary\" onClick={() => {reply()}} before={<Icon16ReplyOutline/>}>\n\t\t\t\t\t\t\t\t\tПоделиться\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t\t<Div style={{paddingBottom: '9rem'}}>\n\t\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"primary\" onClick={go} data-to=\"top\" before={<Icon24CupOutline/>}>\n\t\t\t\t\t\t\t\t\tОткрыть ТОП\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t<FixedLayout filled vertical=\"bottom\">\n\t\t\t\t\t\t\t<Group header={<Header mode=\"secondary\">Получить пасту</Header>}>\n\t\t\t\t\t\t\t\t<Div style={{display: 'flex'}}>\n\t\t\t\t\t\t\t\t\t<Button stretched size=\"l\" style={{ marginRight: 8 }} mode=\"secondary\" onClick={\n\t\t\t\t\t\t\t\t\t\t() => {getRandPaste()}} before={<Icon28Dice5Outline/>}>\n\t\t\t\t\t\t\t\t\t\tСлучайная паста\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t<Button stretched size=\"l\" mode=\"secondary\" onClick={\n\t\t\t\t\t\t\t\t\t\t() => {getPaste()}} before={<Icon28ViewOutline/>}>\n\t\t\t\t\t\t\t\t\t\tНеоцененная паста\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t</FixedLayout>\n\t\t\t\t\t</Group>\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t{snackbar}\n\t\t\t</Panel>\n\t\t</View>\n\t)\n};\n\nHome.propTypes = {\n\tid: PropTypes.string.isRequired,\n\tgo: PropTypes.func.isRequired,\n\tfetchedUser: PropTypes.shape({\n\t\tphoto_200: PropTypes.string,\n\t\tfirst_name: PropTypes.string,\n\t\tlast_name: PropTypes.string,\n\t\tcity: PropTypes.shape({\n\t\t\ttitle: PropTypes.string,\n\t\t}),\n\t}),\n};\n\nexport default Home;\n","import React, {useState, useEffect} from 'react';\nimport PropTypes from 'prop-types';\nimport bridge from '@vkontakte/vk-bridge';\n\nimport { Panel, PanelHeader, PanelHeaderBack, Group, Header, View, ScreenSpinner, Div, Card, Cell, Avatar } from '@vkontakte/vkui';\n\nimport './Top.css';\n\nconst Top = props => {\n\tconst [pastes, setPastes] = useState([])\n\tconst [users, setUsers] = useState([])\n\tconst [you, setYou] = useState(null);\n\tconst [popout, setPopout] = useState(null);\n\n\n\tfunction getTop() {\n\t\tsetPopout(<ScreenSpinner/>)\n\n\t\tfetch('https://lpjakewolfskin.ru/api/v1/paste/get/top/')\n\t\t  .then(response => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow new Error(response.statusText)\n\t\t\t\t}\n\t\t\t\treturn response.json()\n\t\t\t\t}).catch(err=>{\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t\t  .then(pastes => {\n\t\t\tsetPopout(null)\n\t\t\tsetPastes(pastes)\n\t\t  })\n\n\t\tfetch('https://lpjakewolfskin.ru/api/v1/member/get/top/')\n\t\t.then(response => {\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error(response.statusText)\n\t\t\t}\n\t\t\treturn response.json()\n\t\t\t}).catch(err=>{\n\t\t\tconsole.log(err)\n\t\t})\n\t\t.then(users => {\n\t\tsetPopout(null)\n\t\tsetUsers(users)\n\t\t})\n\t}\n\n\tfunction getYou() {\n\t\tsetPopout(<ScreenSpinner/>)\n\n\t\tfetch('https://lpjakewolfskin.ru/api/v1/member/get_vk/' + props.fetchedUser.id)\n\t\t  .then(response => {\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow new Error(response.statusText)\n\t\t\t\t}\n\t\t\t\treturn response.json()\n\t\t\t\t}).catch(err=>{\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\t\t  .then(you => {\n\t\t\tsetPopout(null)\n\t\t\tsetYou(you)\n\t\t  })\n\t}\n\n\tuseEffect(() => {\n\t\tgetTop()\n\t\tgetYou()\n\t  }, [])\n\n\treturn (\n\t\t<View activePanel={props.id} popout={popout}>\n\t\t\t<Panel id={props.id}>\n\t\t\t\t<PanelHeader\n\t\t\t\t\tleft={<PanelHeaderBack onClick={props.go} data-to=\"home\"/>}\n\t\t\t\t>\n\t\t\t\t\tТОП\n\t\t\t\t</PanelHeader>\n\t\t\t\t<Group header={<Header mode=\"secondary\">Это ты</Header>}>\n\t\t\t\t\t<Cell\n\t\t\t\t\t\tbefore={props.fetchedUser.photo_200 ? <Avatar src={props.fetchedUser.photo_200}/> : null}\n\t\t\t\t\t\tdescription={you ? \"Всего оценок: \" + you.cnt + ', средняя: ' + you.avg : \"\"}\n\t\t\t\t\t>\n\t\t\t\t\t\t{`${props.fetchedUser.first_name} ${props.fetchedUser.last_name}`}\n\t\t\t\t\t</Cell>\n\t\t\t\t</Group>\n\t\t\t\t<Group header={<Header mode=\"secondary\">ТОП паст</Header>}>\n\t\t\t\t\t<Div>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpastes.map( (paste, index) => {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Cell\n\t\t\t\t\t\t\t\t\t\tonClick={props.go}\n\t\t\t\t\t\t\t\t\t\tdata-to=\"home\"\n\t\t\t\t\t\t\t\t\t\tdata-payload={paste.id}\n\t\t\t\t\t\t\t\t\t\tkey={paste.id} \n\t\t\t\t\t\t\t\t\t\tstyle={{marginBottom: \".5rem\"}}\n\t\t\t\t\t\t\t\t\t\tdescription={\"Всего оценок: \" + paste.cnt + ', рейтинг: ' + paste.rating}\n\t\t\t\t\t\t\t\t\t\tbefore={<Cell disabled>{index+1}</Cell>}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{paste.anno} \n\t\t\t\t\t\t\t\t\t</Cell>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t</Div>\n\t\t\t\t</Group>\n\t\t\t\t<Group header={<Header mode=\"secondary\">ТОП пользователей</Header>}>\n\t\t\t\t\t<Div>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tusers.map( (user, index) => {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Cell\n\t\t\t\t\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t\t\t\t\tkey={user.id} \n\t\t\t\t\t\t\t\t\t\tstyle={{marginBottom: \".5rem\"}}\n\t\t\t\t\t\t\t\t\t\tdescription={\"Всего оценок: \" + user.cnt + ', средняя: ' + user.avg}\n\t\t\t\t\t\t\t\t\t\tbefore={<Cell disabled>{index+1}</Cell>}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{user.name} \n\t\t\t\t\t\t\t\t\t</Cell>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t</Div>\n\t\t\t\t</Group>\n\t\t\t</Panel>\n\t\t</View>\n\t)\n}\n\nTop.propTypes = {\n\tid: PropTypes.string.isRequired,\n\tgo: PropTypes.func.isRequired,\n};\n\nexport default Top;\n","import React, { useState, useEffect } from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport { View, ScreenSpinner, AdaptivityProvider, AppRoot } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport Home from './panels/Home';\nimport Top from './panels/Top';\n\nconst App = () => {\n\tconst [activePanel, setActivePanel] = useState('home');\n\tconst [fetchedUser, setUser] = useState(null);\n\tconst [pastePreloaded, setPastePreloaded] = useState(null);\n\tconst [popout, setPopout] = useState(<ScreenSpinner size='large' />);\n\n\tuseEffect(() => {\n\t\tbridge.subscribe(({ detail: { type, data }}) => {\n\t\t\tif (type === 'VKWebAppUpdateConfig') {\n\t\t\t\tconst schemeAttribute = document.createAttribute('scheme');\n\t\t\t\tschemeAttribute.value = data.scheme ? data.scheme : 'client_light';\n\t\t\t\tdocument.body.attributes.setNamedItem(schemeAttribute);\n\t\t\t}\n\t\t});\n\t\tasync function fetchData() {\n\t\t\tconst user = await bridge.send('VKWebAppGetUserInfo');\n\t\t\tsetUser(user);\n\t\t\tsetPopout(null);\n\t\t}\n\t\tfetchData();\n\t}, []);\n\n\tconst go = e => {\n\t\tsetActivePanel(e.currentTarget.dataset.to);\n\t\tsetPastePreloaded(e.currentTarget.dataset.payload)\n\t};\n\n\treturn (\n\t\t<AdaptivityProvider>\n\t\t\t<AppRoot>\n\t\t\t\t<View activePanel={activePanel} popout={popout}>\n\t\t\t\t\t{fetchedUser && <Home id='home' fetchedUser={fetchedUser} go={go} pastePreloaded={pastePreloaded}/>}\n\t\t\t\t\t{fetchedUser && <Top id='top' fetchedUser={fetchedUser} go={go}/> }\n\t\t\t\t</View>\n\t\t\t</AppRoot>\n\t\t</AdaptivityProvider>\n\t);\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\nimport './index.css';\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\nif (process.env.NODE_ENV === \"development\") {\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\n}\n"],"sourceRoot":""}